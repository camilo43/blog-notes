{"ast":null,"code":"'use strict';\n\nvar parser = exports;\nvar transport = require('../../../spdy-transport');\nvar base = transport.protocol.base;\nvar utils = base.utils;\nvar constants = require('./').constants;\nvar assert = require('assert');\nvar util = require('util');\nfunction Parser(options) {\n  base.Parser.call(this, options);\n  this.isServer = options.isServer;\n  this.waiting = constants.PREFACE_SIZE;\n  this.state = 'preface';\n  this.pendingHeader = null;\n\n  // Header Block queue\n  this._lastHeaderBlock = null;\n  this.maxFrameSize = constants.INITIAL_MAX_FRAME_SIZE;\n  this.maxHeaderListSize = constants.DEFAULT_MAX_HEADER_LIST_SIZE;\n}\nutil.inherits(Parser, base.Parser);\nparser.create = function create(options) {\n  return new Parser(options);\n};\nParser.prototype.setMaxFrameSize = function setMaxFrameSize(size) {\n  this.maxFrameSize = size;\n};\nParser.prototype.setMaxHeaderListSize = function setMaxHeaderListSize(size) {\n  this.maxHeaderListSize = size;\n};\n\n// Only for testing\nParser.prototype.skipPreface = function skipPreface() {\n  // Just some number bigger than 3.1, doesn't really matter for HTTP2\n  this.setVersion(4);\n\n  // Parse frame header!\n  this.state = 'frame-head';\n  this.waiting = constants.FRAME_HEADER_SIZE;\n};\nParser.prototype.execute = function execute(buffer, callback) {\n  if (this.state === 'preface') {\n    return this.onPreface(buffer, callback);\n  }\n  if (this.state === 'frame-head') {\n    return this.onFrameHead(buffer, callback);\n  }\n  assert(this.state === 'frame-body' && this.pendingHeader !== null);\n  var self = this;\n  var header = this.pendingHeader;\n  this.pendingHeader = null;\n  this.onFrameBody(header, buffer, function (err, frame) {\n    if (err) {\n      return callback(err);\n    }\n    self.state = 'frame-head';\n    self.partial = false;\n    self.waiting = constants.FRAME_HEADER_SIZE;\n    callback(null, frame);\n  });\n};\nParser.prototype.executePartial = function executePartial(buffer, callback) {\n  var header = this.pendingHeader;\n  assert.strictEqual(header.flags & constants.flags.PADDED, 0);\n  if (this.window) {\n    this.window.recv.update(-buffer.size);\n  }\n  callback(null, {\n    type: 'DATA',\n    id: header.id,\n    // Partial DATA can't be FIN\n    fin: false,\n    data: buffer.take(buffer.size)\n  });\n};\nParser.prototype.onPreface = function onPreface(buffer, callback) {\n  if (buffer.take(buffer.size).toString() !== constants.PREFACE) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid preface'));\n  }\n  this.skipPreface();\n  callback(null, null);\n};\nParser.prototype.onFrameHead = function onFrameHead(buffer, callback) {\n  var header = {\n    length: buffer.readUInt24BE(),\n    control: true,\n    type: buffer.readUInt8(),\n    flags: buffer.readUInt8(),\n    id: buffer.readUInt32BE() & 0x7fffffff\n  };\n  if (header.length > this.maxFrameSize) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'Frame length OOB'));\n  }\n  header.control = header.type !== constants.frameType.DATA;\n  this.state = 'frame-body';\n  this.pendingHeader = header;\n  this.waiting = header.length;\n  this.partial = !header.control;\n\n  // TODO(indutny): eventually support partial padded DATA\n  if (this.partial) {\n    this.partial = (header.flags & constants.flags.PADDED) === 0;\n  }\n  callback(null, null);\n};\nParser.prototype.onFrameBody = function onFrameBody(header, buffer, callback) {\n  var frameType = constants.frameType;\n  if (header.type === frameType.DATA) {\n    this.onDataFrame(header, buffer, callback);\n  } else if (header.type === frameType.HEADERS) {\n    this.onHeadersFrame(header, buffer, callback);\n  } else if (header.type === frameType.CONTINUATION) {\n    this.onContinuationFrame(header, buffer, callback);\n  } else if (header.type === frameType.WINDOW_UPDATE) {\n    this.onWindowUpdateFrame(header, buffer, callback);\n  } else if (header.type === frameType.RST_STREAM) {\n    this.onRSTFrame(header, buffer, callback);\n  } else if (header.type === frameType.SETTINGS) {\n    this.onSettingsFrame(header, buffer, callback);\n  } else if (header.type === frameType.PUSH_PROMISE) {\n    this.onPushPromiseFrame(header, buffer, callback);\n  } else if (header.type === frameType.PING) {\n    this.onPingFrame(header, buffer, callback);\n  } else if (header.type === frameType.GOAWAY) {\n    this.onGoawayFrame(header, buffer, callback);\n  } else if (header.type === frameType.PRIORITY) {\n    this.onPriorityFrame(header, buffer, callback);\n  } else if (header.type === frameType.X_FORWARDED_FOR) {\n    this.onXForwardedFrame(header, buffer, callback);\n  } else {\n    this.onUnknownFrame(header, buffer, callback);\n  }\n};\nParser.prototype.onUnknownFrame = function onUnknownFrame(header, buffer, callback) {\n  if (this._lastHeaderBlock !== null) {\n    callback(this.error(constants.error.PROTOCOL_ERROR, 'Received unknown frame in the middle of a header block'));\n    return;\n  }\n  callback(null, {\n    type: 'unknown: ' + header.type\n  });\n};\nParser.prototype.unpadData = function unpadData(header, body, callback) {\n  var isPadded = (header.flags & constants.flags.PADDED) !== 0;\n  if (!isPadded) {\n    return callback(null, body);\n  }\n  if (!body.has(1)) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'Not enough space for padding'));\n  }\n  var pad = body.readUInt8();\n  if (!body.has(pad)) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid padding size'));\n  }\n  var contents = body.clone(body.size - pad);\n  body.skip(body.size);\n  callback(null, contents);\n};\nParser.prototype.onDataFrame = function onDataFrame(header, body, callback) {\n  var isEndStream = (header.flags & constants.flags.END_STREAM) !== 0;\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Received DATA frame with stream=0'));\n  }\n\n  // Count received bytes\n  if (this.window) {\n    this.window.recv.update(-body.size);\n  }\n  this.unpadData(header, body, function (err, data) {\n    if (err) {\n      return callback(err);\n    }\n    callback(null, {\n      type: 'DATA',\n      id: header.id,\n      fin: isEndStream,\n      data: data.take(data.size)\n    });\n  });\n};\nParser.prototype.initHeaderBlock = function initHeaderBlock(header, frame, block, callback) {\n  if (this._lastHeaderBlock) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Duplicate Stream ID'));\n  }\n  this._lastHeaderBlock = {\n    id: header.id,\n    frame: frame,\n    queue: [],\n    size: 0\n  };\n  this.queueHeaderBlock(header, block, callback);\n};\nParser.prototype.queueHeaderBlock = function queueHeaderBlock(header, block, callback) {\n  var self = this;\n  var item = this._lastHeaderBlock;\n  if (!this._lastHeaderBlock || item.id !== header.id) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'No matching stream for continuation'));\n  }\n  var fin = (header.flags & constants.flags.END_HEADERS) !== 0;\n  var chunks = block.toChunks();\n  for (var i = 0; i < chunks.length; i++) {\n    var chunk = chunks[i];\n    item.queue.push(chunk);\n    item.size += chunk.length;\n  }\n  if (item.size >= self.maxHeaderListSize) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Compressed header list is too large'));\n  }\n  if (!fin) {\n    return callback(null, null);\n  }\n  this._lastHeaderBlock = null;\n  this.decompress.write(item.queue, function (err, chunks) {\n    if (err) {\n      return callback(self.error(constants.error.COMPRESSION_ERROR, err.message));\n    }\n    var headers = {};\n    var size = 0;\n    for (var i = 0; i < chunks.length; i++) {\n      var header = chunks[i];\n      size += header.name.length + header.value.length + 32;\n      if (size >= self.maxHeaderListSize) {\n        return callback(self.error(constants.error.PROTOCOL_ERROR, 'Header list is too large'));\n      }\n      if (/[A-Z]/.test(header.name)) {\n        return callback(self.error(constants.error.PROTOCOL_ERROR, 'Header name must be lowercase'));\n      }\n      utils.addHeaderLine(header.name, header.value, headers);\n    }\n    item.frame.headers = headers;\n    item.frame.path = headers[':path'];\n    callback(null, item.frame);\n  });\n};\nParser.prototype.onHeadersFrame = function onHeadersFrame(header, body, callback) {\n  var self = this;\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for HEADERS'));\n  }\n  this.unpadData(header, body, function (err, data) {\n    if (err) {\n      return callback(err);\n    }\n    var isPriority = (header.flags & constants.flags.PRIORITY) !== 0;\n    if (!data.has(isPriority ? 5 : 0)) {\n      return callback(self.error(constants.error.FRAME_SIZE_ERROR, 'Not enough data for HEADERS'));\n    }\n    var exclusive = false;\n    var dependency = 0;\n    var weight = constants.DEFAULT_WEIGHT;\n    if (isPriority) {\n      dependency = data.readUInt32BE();\n      exclusive = (dependency & 0x80000000) !== 0;\n      dependency &= 0x7fffffff;\n\n      // Weight's range is [1, 256]\n      weight = data.readUInt8() + 1;\n    }\n    if (dependency === header.id) {\n      return callback(self.error(constants.error.PROTOCOL_ERROR, 'Stream can\\'t dependend on itself'));\n    }\n    var streamInfo = {\n      type: 'HEADERS',\n      id: header.id,\n      priority: {\n        parent: dependency,\n        exclusive: exclusive,\n        weight: weight\n      },\n      fin: (header.flags & constants.flags.END_STREAM) !== 0,\n      writable: true,\n      headers: null,\n      path: null\n    };\n    self.initHeaderBlock(header, streamInfo, data, callback);\n  });\n};\nParser.prototype.onContinuationFrame = function onContinuationFrame(header, body, callback) {\n  this.queueHeaderBlock(header, body, callback);\n};\nParser.prototype.onRSTFrame = function onRSTFrame(header, body, callback) {\n  if (body.size !== 4) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'RST_STREAM length not 4'));\n  }\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for RST_STREAM'));\n  }\n  callback(null, {\n    type: 'RST',\n    id: header.id,\n    code: constants.errorByCode[body.readUInt32BE()]\n  });\n};\nParser.prototype._validateSettings = function _validateSettings(settings) {\n  if (settings['enable_push'] !== undefined && settings['enable_push'] !== 0 && settings['enable_push'] !== 1) {\n    return this.error(constants.error.PROTOCOL_ERROR, 'SETTINGS_ENABLE_PUSH must be 0 or 1');\n  }\n  if (settings['initial_window_size'] !== undefined && (settings['initial_window_size'] > constants.MAX_INITIAL_WINDOW_SIZE || settings['initial_window_size'] < 0)) {\n    return this.error(constants.error.FLOW_CONTROL_ERROR, 'SETTINGS_INITIAL_WINDOW_SIZE is OOB');\n  }\n  if (settings['max_frame_size'] !== undefined && (settings['max_frame_size'] > constants.ABSOLUTE_MAX_FRAME_SIZE || settings['max_frame_size'] < constants.INITIAL_MAX_FRAME_SIZE)) {\n    return this.error(constants.error.PROTOCOL_ERROR, 'SETTINGS_MAX_FRAME_SIZE is OOB');\n  }\n  return undefined;\n};\nParser.prototype.onSettingsFrame = function onSettingsFrame(header, body, callback) {\n  if (header.id !== 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for SETTINGS'));\n  }\n  var isAck = (header.flags & constants.flags.ACK) !== 0;\n  if (isAck && body.size !== 0) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'SETTINGS with ACK and non-zero length'));\n  }\n  if (isAck) {\n    return callback(null, {\n      type: 'ACK_SETTINGS'\n    });\n  }\n  if (body.size % 6 !== 0) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'SETTINGS length not multiple of 6'));\n  }\n  var settings = {};\n  while (!body.isEmpty()) {\n    var id = body.readUInt16BE();\n    var value = body.readUInt32BE();\n    var name = constants.settingsIndex[id];\n    if (name) {\n      settings[name] = value;\n    }\n  }\n  var err = this._validateSettings(settings);\n  if (err !== undefined) {\n    return callback(err);\n  }\n  callback(null, {\n    type: 'SETTINGS',\n    settings: settings\n  });\n};\nParser.prototype.onPushPromiseFrame = function onPushPromiseFrame(header, body, callback) {\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for PUSH_PROMISE'));\n  }\n  var self = this;\n  this.unpadData(header, body, function (err, data) {\n    if (err) {\n      return callback(err);\n    }\n    if (!data.has(4)) {\n      return callback(self.error(constants.error.FRAME_SIZE_ERROR, 'PUSH_PROMISE length less than 4'));\n    }\n    var streamInfo = {\n      type: 'PUSH_PROMISE',\n      id: header.id,\n      fin: false,\n      promisedId: data.readUInt32BE() & 0x7fffffff,\n      headers: null,\n      path: null\n    };\n    self.initHeaderBlock(header, streamInfo, data, callback);\n  });\n};\nParser.prototype.onPingFrame = function onPingFrame(header, body, callback) {\n  if (body.size !== 8) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'PING length != 8'));\n  }\n  if (header.id !== 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for PING'));\n  }\n  var ack = (header.flags & constants.flags.ACK) !== 0;\n  callback(null, {\n    type: 'PING',\n    opaque: body.take(body.size),\n    ack: ack\n  });\n};\nParser.prototype.onGoawayFrame = function onGoawayFrame(header, body, callback) {\n  if (!body.has(8)) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'GOAWAY length < 8'));\n  }\n  if (header.id !== 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for GOAWAY'));\n  }\n  var frame = {\n    type: 'GOAWAY',\n    lastId: body.readUInt32BE(),\n    code: constants.goawayByCode[body.readUInt32BE()]\n  };\n  if (body.size !== 0) {\n    frame.debug = body.take(body.size);\n  }\n  callback(null, frame);\n};\nParser.prototype.onPriorityFrame = function onPriorityFrame(header, body, callback) {\n  if (body.size !== 5) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'PRIORITY length != 5'));\n  }\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for PRIORITY'));\n  }\n  var dependency = body.readUInt32BE();\n\n  // Again the range is from 1 to 256\n  var weight = body.readUInt8() + 1;\n  if (dependency === header.id) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Stream can\\'t dependend on itself'));\n  }\n  callback(null, {\n    type: 'PRIORITY',\n    id: header.id,\n    priority: {\n      exclusive: (dependency & 0x80000000) !== 0,\n      parent: dependency & 0x7fffffff,\n      weight: weight\n    }\n  });\n};\nParser.prototype.onWindowUpdateFrame = function onWindowUpdateFrame(header, body, callback) {\n  if (body.size !== 4) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR, 'WINDOW_UPDATE length != 4'));\n  }\n  var delta = body.readInt32BE();\n  if (delta === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'WINDOW_UPDATE delta == 0'));\n  }\n  callback(null, {\n    type: 'WINDOW_UPDATE',\n    id: header.id,\n    delta: delta\n  });\n};\nParser.prototype.onXForwardedFrame = function onXForwardedFrame(header, body, callback) {\n  callback(null, {\n    type: 'X_FORWARDED_FOR',\n    host: body.take(body.size).toString()\n  });\n};","map":{"version":3,"names":["parser","exports","transport","require","base","protocol","utils","constants","assert","util","Parser","options","call","isServer","waiting","PREFACE_SIZE","state","pendingHeader","_lastHeaderBlock","maxFrameSize","INITIAL_MAX_FRAME_SIZE","maxHeaderListSize","DEFAULT_MAX_HEADER_LIST_SIZE","inherits","create","prototype","setMaxFrameSize","size","setMaxHeaderListSize","skipPreface","setVersion","FRAME_HEADER_SIZE","execute","buffer","callback","onPreface","onFrameHead","self","header","onFrameBody","err","frame","partial","executePartial","strictEqual","flags","PADDED","window","recv","update","type","id","fin","data","take","toString","PREFACE","error","PROTOCOL_ERROR","length","readUInt24BE","control","readUInt8","readUInt32BE","FRAME_SIZE_ERROR","frameType","DATA","onDataFrame","HEADERS","onHeadersFrame","CONTINUATION","onContinuationFrame","WINDOW_UPDATE","onWindowUpdateFrame","RST_STREAM","onRSTFrame","SETTINGS","onSettingsFrame","PUSH_PROMISE","onPushPromiseFrame","PING","onPingFrame","GOAWAY","onGoawayFrame","PRIORITY","onPriorityFrame","X_FORWARDED_FOR","onXForwardedFrame","onUnknownFrame","unpadData","body","isPadded","has","pad","contents","clone","skip","isEndStream","END_STREAM","initHeaderBlock","block","queue","queueHeaderBlock","item","END_HEADERS","chunks","toChunks","i","chunk","push","decompress","write","COMPRESSION_ERROR","message","headers","name","value","test","addHeaderLine","path","isPriority","exclusive","dependency","weight","DEFAULT_WEIGHT","streamInfo","priority","parent","writable","code","errorByCode","_validateSettings","settings","undefined","MAX_INITIAL_WINDOW_SIZE","FLOW_CONTROL_ERROR","ABSOLUTE_MAX_FRAME_SIZE","isAck","ACK","isEmpty","readUInt16BE","settingsIndex","promisedId","ack","opaque","lastId","goawayByCode","debug","delta","readInt32BE","host"],"sources":["/Users/juancvegao/Documents/PROGRAMMING/REACT/ejerciciosUniversidad/notes_github/frontend/node_modules/spdy-transport/lib/spdy-transport/protocol/http2/parser.js"],"sourcesContent":["'use strict'\n\nvar parser = exports\n\nvar transport = require('../../../spdy-transport')\nvar base = transport.protocol.base\nvar utils = base.utils\nvar constants = require('./').constants\n\nvar assert = require('assert')\nvar util = require('util')\n\nfunction Parser (options) {\n  base.Parser.call(this, options)\n\n  this.isServer = options.isServer\n\n  this.waiting = constants.PREFACE_SIZE\n  this.state = 'preface'\n  this.pendingHeader = null\n\n  // Header Block queue\n  this._lastHeaderBlock = null\n  this.maxFrameSize = constants.INITIAL_MAX_FRAME_SIZE\n  this.maxHeaderListSize = constants.DEFAULT_MAX_HEADER_LIST_SIZE\n}\nutil.inherits(Parser, base.Parser)\n\nparser.create = function create (options) {\n  return new Parser(options)\n}\n\nParser.prototype.setMaxFrameSize = function setMaxFrameSize (size) {\n  this.maxFrameSize = size\n}\n\nParser.prototype.setMaxHeaderListSize = function setMaxHeaderListSize (size) {\n  this.maxHeaderListSize = size\n}\n\n// Only for testing\nParser.prototype.skipPreface = function skipPreface () {\n  // Just some number bigger than 3.1, doesn't really matter for HTTP2\n  this.setVersion(4)\n\n  // Parse frame header!\n  this.state = 'frame-head'\n  this.waiting = constants.FRAME_HEADER_SIZE\n}\n\nParser.prototype.execute = function execute (buffer, callback) {\n  if (this.state === 'preface') { return this.onPreface(buffer, callback) }\n\n  if (this.state === 'frame-head') {\n    return this.onFrameHead(buffer, callback)\n  }\n\n  assert(this.state === 'frame-body' && this.pendingHeader !== null)\n\n  var self = this\n  var header = this.pendingHeader\n  this.pendingHeader = null\n\n  this.onFrameBody(header, buffer, function (err, frame) {\n    if (err) {\n      return callback(err)\n    }\n\n    self.state = 'frame-head'\n    self.partial = false\n    self.waiting = constants.FRAME_HEADER_SIZE\n    callback(null, frame)\n  })\n}\n\nParser.prototype.executePartial = function executePartial (buffer, callback) {\n  var header = this.pendingHeader\n\n  assert.strictEqual(header.flags & constants.flags.PADDED, 0)\n\n  if (this.window) { this.window.recv.update(-buffer.size) }\n\n  callback(null, {\n    type: 'DATA',\n    id: header.id,\n\n    // Partial DATA can't be FIN\n    fin: false,\n    data: buffer.take(buffer.size)\n  })\n}\n\nParser.prototype.onPreface = function onPreface (buffer, callback) {\n  if (buffer.take(buffer.size).toString() !== constants.PREFACE) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid preface'))\n  }\n\n  this.skipPreface()\n  callback(null, null)\n}\n\nParser.prototype.onFrameHead = function onFrameHead (buffer, callback) {\n  var header = {\n    length: buffer.readUInt24BE(),\n    control: true,\n    type: buffer.readUInt8(),\n    flags: buffer.readUInt8(),\n    id: buffer.readUInt32BE() & 0x7fffffff\n  }\n\n  if (header.length > this.maxFrameSize) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'Frame length OOB'))\n  }\n\n  header.control = header.type !== constants.frameType.DATA\n\n  this.state = 'frame-body'\n  this.pendingHeader = header\n  this.waiting = header.length\n  this.partial = !header.control\n\n  // TODO(indutny): eventually support partial padded DATA\n  if (this.partial) {\n    this.partial = (header.flags & constants.flags.PADDED) === 0\n  }\n\n  callback(null, null)\n}\n\nParser.prototype.onFrameBody = function onFrameBody (header, buffer, callback) {\n  var frameType = constants.frameType\n\n  if (header.type === frameType.DATA) {\n    this.onDataFrame(header, buffer, callback)\n  } else if (header.type === frameType.HEADERS) {\n    this.onHeadersFrame(header, buffer, callback)\n  } else if (header.type === frameType.CONTINUATION) {\n    this.onContinuationFrame(header, buffer, callback)\n  } else if (header.type === frameType.WINDOW_UPDATE) {\n    this.onWindowUpdateFrame(header, buffer, callback)\n  } else if (header.type === frameType.RST_STREAM) {\n    this.onRSTFrame(header, buffer, callback)\n  } else if (header.type === frameType.SETTINGS) {\n    this.onSettingsFrame(header, buffer, callback)\n  } else if (header.type === frameType.PUSH_PROMISE) {\n    this.onPushPromiseFrame(header, buffer, callback)\n  } else if (header.type === frameType.PING) {\n    this.onPingFrame(header, buffer, callback)\n  } else if (header.type === frameType.GOAWAY) {\n    this.onGoawayFrame(header, buffer, callback)\n  } else if (header.type === frameType.PRIORITY) {\n    this.onPriorityFrame(header, buffer, callback)\n  } else if (header.type === frameType.X_FORWARDED_FOR) {\n    this.onXForwardedFrame(header, buffer, callback)\n  } else {\n    this.onUnknownFrame(header, buffer, callback)\n  }\n}\n\nParser.prototype.onUnknownFrame = function onUnknownFrame (header, buffer, callback) {\n  if (this._lastHeaderBlock !== null) {\n    callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Received unknown frame in the middle of a header block'))\n    return\n  }\n  callback(null, { type: 'unknown: ' + header.type })\n}\n\nParser.prototype.unpadData = function unpadData (header, body, callback) {\n  var isPadded = (header.flags & constants.flags.PADDED) !== 0\n\n  if (!isPadded) { return callback(null, body) }\n\n  if (!body.has(1)) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'Not enough space for padding'))\n  }\n\n  var pad = body.readUInt8()\n  if (!body.has(pad)) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid padding size'))\n  }\n\n  var contents = body.clone(body.size - pad)\n  body.skip(body.size)\n  callback(null, contents)\n}\n\nParser.prototype.onDataFrame = function onDataFrame (header, body, callback) {\n  var isEndStream = (header.flags & constants.flags.END_STREAM) !== 0\n\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Received DATA frame with stream=0'))\n  }\n\n  // Count received bytes\n  if (this.window) {\n    this.window.recv.update(-body.size)\n  }\n\n  this.unpadData(header, body, function (err, data) {\n    if (err) {\n      return callback(err)\n    }\n\n    callback(null, {\n      type: 'DATA',\n      id: header.id,\n      fin: isEndStream,\n      data: data.take(data.size)\n    })\n  })\n}\n\nParser.prototype.initHeaderBlock = function initHeaderBlock (header,\n  frame,\n  block,\n  callback) {\n  if (this._lastHeaderBlock) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Duplicate Stream ID'))\n  }\n\n  this._lastHeaderBlock = {\n    id: header.id,\n    frame: frame,\n    queue: [],\n    size: 0\n  }\n\n  this.queueHeaderBlock(header, block, callback)\n}\n\nParser.prototype.queueHeaderBlock = function queueHeaderBlock (header,\n  block,\n  callback) {\n  var self = this\n  var item = this._lastHeaderBlock\n  if (!this._lastHeaderBlock || item.id !== header.id) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'No matching stream for continuation'))\n  }\n\n  var fin = (header.flags & constants.flags.END_HEADERS) !== 0\n\n  var chunks = block.toChunks()\n  for (var i = 0; i < chunks.length; i++) {\n    var chunk = chunks[i]\n    item.queue.push(chunk)\n    item.size += chunk.length\n  }\n\n  if (item.size >= self.maxHeaderListSize) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Compressed header list is too large'))\n  }\n\n  if (!fin) { return callback(null, null) }\n  this._lastHeaderBlock = null\n\n  this.decompress.write(item.queue, function (err, chunks) {\n    if (err) {\n      return callback(self.error(constants.error.COMPRESSION_ERROR,\n        err.message))\n    }\n\n    var headers = {}\n    var size = 0\n    for (var i = 0; i < chunks.length; i++) {\n      var header = chunks[i]\n\n      size += header.name.length + header.value.length + 32\n      if (size >= self.maxHeaderListSize) {\n        return callback(self.error(constants.error.PROTOCOL_ERROR,\n          'Header list is too large'))\n      }\n\n      if (/[A-Z]/.test(header.name)) {\n        return callback(self.error(constants.error.PROTOCOL_ERROR,\n          'Header name must be lowercase'))\n      }\n\n      utils.addHeaderLine(header.name, header.value, headers)\n    }\n\n    item.frame.headers = headers\n    item.frame.path = headers[':path']\n\n    callback(null, item.frame)\n  })\n}\n\nParser.prototype.onHeadersFrame = function onHeadersFrame (header,\n  body,\n  callback) {\n  var self = this\n\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for HEADERS'))\n  }\n\n  this.unpadData(header, body, function (err, data) {\n    if (err) { return callback(err) }\n\n    var isPriority = (header.flags & constants.flags.PRIORITY) !== 0\n    if (!data.has(isPriority ? 5 : 0)) {\n      return callback(self.error(constants.error.FRAME_SIZE_ERROR,\n        'Not enough data for HEADERS'))\n    }\n\n    var exclusive = false\n    var dependency = 0\n    var weight = constants.DEFAULT_WEIGHT\n    if (isPriority) {\n      dependency = data.readUInt32BE()\n      exclusive = (dependency & 0x80000000) !== 0\n      dependency &= 0x7fffffff\n\n      // Weight's range is [1, 256]\n      weight = data.readUInt8() + 1\n    }\n\n    if (dependency === header.id) {\n      return callback(self.error(constants.error.PROTOCOL_ERROR,\n        'Stream can\\'t dependend on itself'))\n    }\n\n    var streamInfo = {\n      type: 'HEADERS',\n      id: header.id,\n      priority: {\n        parent: dependency,\n        exclusive: exclusive,\n        weight: weight\n      },\n      fin: (header.flags & constants.flags.END_STREAM) !== 0,\n      writable: true,\n      headers: null,\n      path: null\n    }\n\n    self.initHeaderBlock(header, streamInfo, data, callback)\n  })\n}\n\nParser.prototype.onContinuationFrame = function onContinuationFrame (header,\n  body,\n  callback) {\n  this.queueHeaderBlock(header, body, callback)\n}\n\nParser.prototype.onRSTFrame = function onRSTFrame (header, body, callback) {\n  if (body.size !== 4) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'RST_STREAM length not 4'))\n  }\n\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for RST_STREAM'))\n  }\n\n  callback(null, {\n    type: 'RST',\n    id: header.id,\n    code: constants.errorByCode[body.readUInt32BE()]\n  })\n}\n\nParser.prototype._validateSettings = function _validateSettings (settings) {\n  if (settings['enable_push'] !== undefined &&\n      settings['enable_push'] !== 0 &&\n      settings['enable_push'] !== 1) {\n    return this.error(constants.error.PROTOCOL_ERROR,\n      'SETTINGS_ENABLE_PUSH must be 0 or 1')\n  }\n\n  if (settings['initial_window_size'] !== undefined &&\n      (settings['initial_window_size'] > constants.MAX_INITIAL_WINDOW_SIZE ||\n       settings['initial_window_size'] < 0)) {\n    return this.error(constants.error.FLOW_CONTROL_ERROR,\n      'SETTINGS_INITIAL_WINDOW_SIZE is OOB')\n  }\n\n  if (settings['max_frame_size'] !== undefined &&\n      (settings['max_frame_size'] > constants.ABSOLUTE_MAX_FRAME_SIZE ||\n       settings['max_frame_size'] < constants.INITIAL_MAX_FRAME_SIZE)) {\n    return this.error(constants.error.PROTOCOL_ERROR,\n      'SETTINGS_MAX_FRAME_SIZE is OOB')\n  }\n\n  return undefined\n}\n\nParser.prototype.onSettingsFrame = function onSettingsFrame (header,\n  body,\n  callback) {\n  if (header.id !== 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for SETTINGS'))\n  }\n\n  var isAck = (header.flags & constants.flags.ACK) !== 0\n  if (isAck && body.size !== 0) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'SETTINGS with ACK and non-zero length'))\n  }\n\n  if (isAck) {\n    return callback(null, { type: 'ACK_SETTINGS' })\n  }\n\n  if (body.size % 6 !== 0) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'SETTINGS length not multiple of 6'))\n  }\n\n  var settings = {}\n  while (!body.isEmpty()) {\n    var id = body.readUInt16BE()\n    var value = body.readUInt32BE()\n    var name = constants.settingsIndex[id]\n\n    if (name) {\n      settings[name] = value\n    }\n  }\n\n  var err = this._validateSettings(settings)\n  if (err !== undefined) {\n    return callback(err)\n  }\n\n  callback(null, {\n    type: 'SETTINGS',\n    settings: settings\n  })\n}\n\nParser.prototype.onPushPromiseFrame = function onPushPromiseFrame (header,\n  body,\n  callback) {\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for PUSH_PROMISE'))\n  }\n\n  var self = this\n  this.unpadData(header, body, function (err, data) {\n    if (err) {\n      return callback(err)\n    }\n\n    if (!data.has(4)) {\n      return callback(self.error(constants.error.FRAME_SIZE_ERROR,\n        'PUSH_PROMISE length less than 4'))\n    }\n\n    var streamInfo = {\n      type: 'PUSH_PROMISE',\n      id: header.id,\n      fin: false,\n      promisedId: data.readUInt32BE() & 0x7fffffff,\n      headers: null,\n      path: null\n    }\n\n    self.initHeaderBlock(header, streamInfo, data, callback)\n  })\n}\n\nParser.prototype.onPingFrame = function onPingFrame (header, body, callback) {\n  if (body.size !== 8) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'PING length != 8'))\n  }\n\n  if (header.id !== 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for PING'))\n  }\n\n  var ack = (header.flags & constants.flags.ACK) !== 0\n  callback(null, { type: 'PING', opaque: body.take(body.size), ack: ack })\n}\n\nParser.prototype.onGoawayFrame = function onGoawayFrame (header,\n  body,\n  callback) {\n  if (!body.has(8)) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'GOAWAY length < 8'))\n  }\n\n  if (header.id !== 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for GOAWAY'))\n  }\n\n  var frame = {\n    type: 'GOAWAY',\n    lastId: body.readUInt32BE(),\n    code: constants.goawayByCode[body.readUInt32BE()]\n  }\n\n  if (body.size !== 0) { frame.debug = body.take(body.size) }\n\n  callback(null, frame)\n}\n\nParser.prototype.onPriorityFrame = function onPriorityFrame (header,\n  body,\n  callback) {\n  if (body.size !== 5) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'PRIORITY length != 5'))\n  }\n\n  if (header.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for PRIORITY'))\n  }\n\n  var dependency = body.readUInt32BE()\n\n  // Again the range is from 1 to 256\n  var weight = body.readUInt8() + 1\n\n  if (dependency === header.id) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Stream can\\'t dependend on itself'))\n  }\n\n  callback(null, {\n    type: 'PRIORITY',\n    id: header.id,\n    priority: {\n      exclusive: (dependency & 0x80000000) !== 0,\n      parent: dependency & 0x7fffffff,\n      weight: weight\n    }\n  })\n}\n\nParser.prototype.onWindowUpdateFrame = function onWindowUpdateFrame (header,\n  body,\n  callback) {\n  if (body.size !== 4) {\n    return callback(this.error(constants.error.FRAME_SIZE_ERROR,\n      'WINDOW_UPDATE length != 4'))\n  }\n\n  var delta = body.readInt32BE()\n  if (delta === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'WINDOW_UPDATE delta == 0'))\n  }\n\n  callback(null, {\n    type: 'WINDOW_UPDATE',\n    id: header.id,\n    delta: delta\n  })\n}\n\nParser.prototype.onXForwardedFrame = function onXForwardedFrame (header,\n  body,\n  callback) {\n  callback(null, {\n    type: 'X_FORWARDED_FOR',\n    host: body.take(body.size).toString()\n  })\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}