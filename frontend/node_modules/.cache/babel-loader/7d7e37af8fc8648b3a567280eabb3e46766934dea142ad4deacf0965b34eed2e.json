{"ast":null,"code":"'use strict';\n\nvar parser = exports;\nvar transport = require('../../../spdy-transport');\nvar base = transport.protocol.base;\nvar utils = base.utils;\nvar constants = require('./constants');\nvar assert = require('assert');\nvar util = require('util');\nvar OffsetBuffer = require('obuf');\nfunction Parser(options) {\n  base.Parser.call(this, options);\n  this.isServer = options.isServer;\n  this.waiting = constants.FRAME_HEADER_SIZE;\n  this.state = 'frame-head';\n  this.pendingHeader = null;\n}\nutil.inherits(Parser, base.Parser);\nparser.create = function create(options) {\n  return new Parser(options);\n};\nParser.prototype.setMaxFrameSize = function setMaxFrameSize(size) {\n  // http2-only\n};\nParser.prototype.setMaxHeaderListSize = function setMaxHeaderListSize(size) {\n  // http2-only\n};\n\n// Only for testing\nParser.prototype.skipPreface = function skipPreface() {};\nParser.prototype.execute = function execute(buffer, callback) {\n  if (this.state === 'frame-head') {\n    return this.onFrameHead(buffer, callback);\n  }\n  assert(this.state === 'frame-body' && this.pendingHeader !== null);\n  var self = this;\n  var header = this.pendingHeader;\n  this.pendingHeader = null;\n  this.onFrameBody(header, buffer, function (err, frame) {\n    if (err) {\n      return callback(err);\n    }\n    self.state = 'frame-head';\n    self.waiting = constants.FRAME_HEADER_SIZE;\n    self.partial = false;\n    callback(null, frame);\n  });\n};\nParser.prototype.executePartial = function executePartial(buffer, callback) {\n  var header = this.pendingHeader;\n  if (this.window) {\n    this.window.recv.update(-buffer.size);\n  }\n\n  // DATA frame\n  callback(null, {\n    type: 'DATA',\n    id: header.id,\n    // Partial DATA can't be FIN\n    fin: false,\n    data: buffer.take(buffer.size)\n  });\n};\nParser.prototype.onFrameHead = function onFrameHead(buffer, callback) {\n  var header = {\n    control: (buffer.peekUInt8() & 0x80) === 0x80,\n    version: null,\n    type: null,\n    id: null,\n    flags: null,\n    length: null\n  };\n  if (header.control) {\n    header.version = buffer.readUInt16BE() & 0x7fff;\n    header.type = buffer.readUInt16BE();\n  } else {\n    header.id = buffer.readUInt32BE(0) & 0x7fffffff;\n  }\n  header.flags = buffer.readUInt8();\n  header.length = buffer.readUInt24BE();\n  if (this.version === null && header.control) {\n    // TODO(indutny): do ProtocolError here and in the rest of errors\n    if (header.version !== 2 && header.version !== 3) {\n      return callback(new Error('Unsupported SPDY version: ' + header.version));\n    }\n    this.setVersion(header.version);\n  }\n  this.state = 'frame-body';\n  this.waiting = header.length;\n  this.pendingHeader = header;\n  this.partial = !header.control;\n  callback(null, null);\n};\nParser.prototype.onFrameBody = function onFrameBody(header, buffer, callback) {\n  // Data frame\n  if (!header.control) {\n    // Count received bytes\n    if (this.window) {\n      this.window.recv.update(-buffer.size);\n    }\n\n    // No support for compressed DATA\n    if ((header.flags & constants.flags.FLAG_COMPRESSED) !== 0) {\n      return callback(new Error('DATA compression not supported'));\n    }\n    if (header.id === 0) {\n      return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for DATA'));\n    }\n    return callback(null, {\n      type: 'DATA',\n      id: header.id,\n      fin: (header.flags & constants.flags.FLAG_FIN) !== 0,\n      data: buffer.take(buffer.size)\n    });\n  }\n  if (header.type === 0x01 || header.type === 0x02) {\n    // SYN_STREAM or SYN_REPLY\n    this.onSynHeadFrame(header.type, header.flags, buffer, callback);\n  } else if (header.type === 0x03) {\n    // RST_STREAM\n    this.onRSTFrame(buffer, callback);\n  } else if (header.type === 0x04) {\n    // SETTINGS\n    this.onSettingsFrame(buffer, callback);\n  } else if (header.type === 0x05) {\n    callback(null, {\n      type: 'NOOP'\n    });\n  } else if (header.type === 0x06) {\n    // PING\n    this.onPingFrame(buffer, callback);\n  } else if (header.type === 0x07) {\n    // GOAWAY\n    this.onGoawayFrame(buffer, callback);\n  } else if (header.type === 0x08) {\n    // HEADERS\n    this.onHeaderFrames(buffer, callback);\n  } else if (header.type === 0x09) {\n    // WINDOW_UPDATE\n    this.onWindowUpdateFrame(buffer, callback);\n  } else if (header.type === 0xf000) {\n    // X-FORWARDED\n    this.onXForwardedFrame(buffer, callback);\n  } else {\n    callback(null, {\n      type: 'unknown: ' + header.type\n    });\n  }\n};\nParser.prototype._filterHeader = function _filterHeader(headers, name) {\n  var res = {};\n  var keys = Object.keys(headers);\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (key !== name) {\n      res[key] = headers[key];\n    }\n  }\n  return res;\n};\nParser.prototype.onSynHeadFrame = function onSynHeadFrame(type, flags, body, callback) {\n  var self = this;\n  var stream = type === 0x01;\n  var offset = stream ? 10 : this.version === 2 ? 6 : 4;\n  if (!body.has(offset)) {\n    return callback(new Error('SynHead OOB'));\n  }\n  var head = body.clone(offset);\n  body.skip(offset);\n  this.parseKVs(body, function (err, headers) {\n    if (err) {\n      return callback(err);\n    }\n    if (stream && (!headers[':method'] || !headers[':path'])) {\n      return callback(new Error('Missing `:method` and/or `:path` header'));\n    }\n    var id = head.readUInt32BE() & 0x7fffffff;\n    if (id === 0) {\n      return callback(self.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for HEADERS'));\n    }\n    var associated = stream ? head.readUInt32BE() & 0x7fffffff : 0;\n    var priority = stream ? head.readUInt8() >> 5 : utils.weightToPriority(constants.DEFAULT_WEIGHT);\n    var fin = (flags & constants.flags.FLAG_FIN) !== 0;\n    var unidir = (flags & constants.flags.FLAG_UNIDIRECTIONAL) !== 0;\n    var path = headers[':path'];\n    var isPush = stream && associated !== 0;\n    var weight = utils.priorityToWeight(priority);\n    var priorityInfo = {\n      weight: weight,\n      exclusive: false,\n      parent: 0\n    };\n    if (!isPush) {\n      callback(null, {\n        type: 'HEADERS',\n        id: id,\n        priority: priorityInfo,\n        fin: fin,\n        writable: !unidir,\n        headers: headers,\n        path: path\n      });\n      return;\n    }\n    if (stream && !headers[':status']) {\n      return callback(new Error('Missing `:status` header'));\n    }\n    var filteredHeaders = self._filterHeader(headers, ':status');\n    callback(null, [{\n      type: 'PUSH_PROMISE',\n      id: associated,\n      fin: false,\n      promisedId: id,\n      headers: filteredHeaders,\n      path: path\n    }, {\n      type: 'HEADERS',\n      id: id,\n      fin: fin,\n      priority: priorityInfo,\n      writable: true,\n      path: undefined,\n      headers: {\n        ':status': headers[':status']\n      }\n    }]);\n  });\n};\nParser.prototype.onHeaderFrames = function onHeaderFrames(body, callback) {\n  var offset = this.version === 2 ? 6 : 4;\n  if (!body.has(offset)) {\n    return callback(new Error('HEADERS OOB'));\n  }\n  var streamId = body.readUInt32BE() & 0x7fffffff;\n  if (this.version === 2) {\n    body.skip(2);\n  }\n  this.parseKVs(body, function (err, headers) {\n    if (err) {\n      return callback(err);\n    }\n    callback(null, {\n      type: 'HEADERS',\n      priority: {\n        parent: 0,\n        exclusive: false,\n        weight: constants.DEFAULT_WEIGHT\n      },\n      id: streamId,\n      fin: false,\n      writable: true,\n      path: undefined,\n      headers: headers\n    });\n  });\n};\nParser.prototype.parseKVs = function parseKVs(buffer, callback) {\n  var self = this;\n  this.decompress.write(buffer.toChunks(), function (err, chunks) {\n    if (err) {\n      return callback(err);\n    }\n    var buffer = new OffsetBuffer();\n    for (var i = 0; i < chunks.length; i++) {\n      buffer.push(chunks[i]);\n    }\n    var size = self.version === 2 ? 2 : 4;\n    if (!buffer.has(size)) {\n      return callback(new Error('KV OOB'));\n    }\n    var count = self.version === 2 ? buffer.readUInt16BE() : buffer.readUInt32BE();\n    var headers = {};\n    function readString() {\n      if (!buffer.has(size)) {\n        return null;\n      }\n      var len = self.version === 2 ? buffer.readUInt16BE() : buffer.readUInt32BE();\n      if (!buffer.has(len)) {\n        return null;\n      }\n      var value = buffer.take(len);\n      return value.toString();\n    }\n    while (count > 0) {\n      var key = readString();\n      var value = readString();\n      if (key === null || value === null) {\n        return callback(new Error('Headers OOB'));\n      }\n      if (self.version < 3) {\n        var isInternal = /^(method|version|url|host|scheme|status)$/.test(key);\n        if (key === 'url') {\n          key = 'path';\n        }\n        if (isInternal) {\n          key = ':' + key;\n        }\n      }\n\n      // Compatibility with HTTP2\n      if (key === ':status') {\n        value = value.split(/ /g, 2)[0];\n      }\n      count--;\n      if (key === ':host') {\n        key = ':authority';\n      }\n\n      // Skip version, not present in HTTP2\n      if (key === ':version') {\n        continue;\n      }\n      value = value.split(/\\0/g);\n      for (var j = 0; j < value.length; j++) {\n        utils.addHeaderLine(key, value[j], headers);\n      }\n    }\n    callback(null, headers);\n  });\n};\nParser.prototype.onRSTFrame = function onRSTFrame(body, callback) {\n  if (!body.has(8)) {\n    return callback(new Error('RST OOB'));\n  }\n  var frame = {\n    type: 'RST',\n    id: body.readUInt32BE() & 0x7fffffff,\n    code: constants.errorByCode[body.readUInt32BE()]\n  };\n  if (frame.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR, 'Invalid stream id for RST'));\n  }\n  if (body.size !== 0) {\n    frame.extra = body.take(body.size);\n  }\n  callback(null, frame);\n};\nParser.prototype.onSettingsFrame = function onSettingsFrame(body, callback) {\n  if (!body.has(4)) {\n    return callback(new Error('SETTINGS OOB'));\n  }\n  var settings = {};\n  var number = body.readUInt32BE();\n  var idMap = {\n    1: 'upload_bandwidth',\n    2: 'download_bandwidth',\n    3: 'round_trip_time',\n    4: 'max_concurrent_streams',\n    5: 'current_cwnd',\n    6: 'download_retrans_rate',\n    7: 'initial_window_size',\n    8: 'client_certificate_vector_size'\n  };\n  if (!body.has(number * 8)) {\n    return callback(new Error('SETTINGS OOB#2'));\n  }\n  for (var i = 0; i < number; i++) {\n    var id = this.version === 2 ? body.readUInt32LE() : body.readUInt32BE();\n    var flags = id >> 24 & 0xff;\n    id = id & 0xffffff;\n\n    // Skip persisted settings\n    if (flags & 0x2) {\n      continue;\n    }\n    var name = idMap[id];\n    settings[name] = body.readUInt32BE();\n  }\n  callback(null, {\n    type: 'SETTINGS',\n    settings: settings\n  });\n};\nParser.prototype.onPingFrame = function onPingFrame(body, callback) {\n  if (!body.has(4)) {\n    return callback(new Error('PING OOB'));\n  }\n  var isServer = this.isServer;\n  var opaque = body.clone(body.size).take(body.size);\n  var id = body.readUInt32BE();\n  var ack = isServer ? id % 2 === 0 : id % 2 === 1;\n  callback(null, {\n    type: 'PING',\n    opaque: opaque,\n    ack: ack\n  });\n};\nParser.prototype.onGoawayFrame = function onGoawayFrame(body, callback) {\n  if (!body.has(8)) {\n    return callback(new Error('GOAWAY OOB'));\n  }\n  callback(null, {\n    type: 'GOAWAY',\n    lastId: body.readUInt32BE() & 0x7fffffff,\n    code: constants.goawayByCode[body.readUInt32BE()]\n  });\n};\nParser.prototype.onWindowUpdateFrame = function onWindowUpdateFrame(body, callback) {\n  if (!body.has(8)) {\n    return callback(new Error('WINDOW_UPDATE OOB'));\n  }\n  callback(null, {\n    type: 'WINDOW_UPDATE',\n    id: body.readUInt32BE() & 0x7fffffff,\n    delta: body.readInt32BE()\n  });\n};\nParser.prototype.onXForwardedFrame = function onXForwardedFrame(body, callback) {\n  if (!body.has(4)) {\n    return callback(new Error('X_FORWARDED OOB'));\n  }\n  var len = body.readUInt32BE();\n  if (!body.has(len)) {\n    return callback(new Error('X_FORWARDED host length OOB'));\n  }\n  callback(null, {\n    type: 'X_FORWARDED_FOR',\n    host: body.take(len).toString()\n  });\n};","map":{"version":3,"names":["parser","exports","transport","require","base","protocol","utils","constants","assert","util","OffsetBuffer","Parser","options","call","isServer","waiting","FRAME_HEADER_SIZE","state","pendingHeader","inherits","create","prototype","setMaxFrameSize","size","setMaxHeaderListSize","skipPreface","execute","buffer","callback","onFrameHead","self","header","onFrameBody","err","frame","partial","executePartial","window","recv","update","type","id","fin","data","take","control","peekUInt8","version","flags","length","readUInt16BE","readUInt32BE","readUInt8","readUInt24BE","Error","setVersion","FLAG_COMPRESSED","error","PROTOCOL_ERROR","FLAG_FIN","onSynHeadFrame","onRSTFrame","onSettingsFrame","onPingFrame","onGoawayFrame","onHeaderFrames","onWindowUpdateFrame","onXForwardedFrame","_filterHeader","headers","name","res","keys","Object","i","key","body","stream","offset","has","head","clone","skip","parseKVs","associated","priority","weightToPriority","DEFAULT_WEIGHT","unidir","FLAG_UNIDIRECTIONAL","path","isPush","weight","priorityToWeight","priorityInfo","exclusive","parent","writable","filteredHeaders","promisedId","undefined","streamId","decompress","write","toChunks","chunks","push","count","readString","len","value","toString","isInternal","test","split","j","addHeaderLine","code","errorByCode","extra","settings","number","idMap","readUInt32LE","opaque","ack","lastId","goawayByCode","delta","readInt32BE","host"],"sources":["/Users/juancvegao/Documents/PROGRAMMING/REACT/ejerciciosUniversidad/notes_github/frontend/node_modules/spdy-transport/lib/spdy-transport/protocol/spdy/parser.js"],"sourcesContent":["'use strict'\n\nvar parser = exports\n\nvar transport = require('../../../spdy-transport')\nvar base = transport.protocol.base\nvar utils = base.utils\nvar constants = require('./constants')\n\nvar assert = require('assert')\nvar util = require('util')\nvar OffsetBuffer = require('obuf')\n\nfunction Parser (options) {\n  base.Parser.call(this, options)\n\n  this.isServer = options.isServer\n  this.waiting = constants.FRAME_HEADER_SIZE\n  this.state = 'frame-head'\n  this.pendingHeader = null\n}\nutil.inherits(Parser, base.Parser)\n\nparser.create = function create (options) {\n  return new Parser(options)\n}\n\nParser.prototype.setMaxFrameSize = function setMaxFrameSize (size) {\n  // http2-only\n}\n\nParser.prototype.setMaxHeaderListSize = function setMaxHeaderListSize (size) {\n  // http2-only\n}\n\n// Only for testing\nParser.prototype.skipPreface = function skipPreface () {\n}\n\nParser.prototype.execute = function execute (buffer, callback) {\n  if (this.state === 'frame-head') { return this.onFrameHead(buffer, callback) }\n\n  assert(this.state === 'frame-body' && this.pendingHeader !== null)\n\n  var self = this\n  var header = this.pendingHeader\n  this.pendingHeader = null\n\n  this.onFrameBody(header, buffer, function (err, frame) {\n    if (err) {\n      return callback(err)\n    }\n\n    self.state = 'frame-head'\n    self.waiting = constants.FRAME_HEADER_SIZE\n    self.partial = false\n    callback(null, frame)\n  })\n}\n\nParser.prototype.executePartial = function executePartial (buffer, callback) {\n  var header = this.pendingHeader\n\n  if (this.window) {\n    this.window.recv.update(-buffer.size)\n  }\n\n  // DATA frame\n  callback(null, {\n    type: 'DATA',\n    id: header.id,\n\n    // Partial DATA can't be FIN\n    fin: false,\n    data: buffer.take(buffer.size)\n  })\n}\n\nParser.prototype.onFrameHead = function onFrameHead (buffer, callback) {\n  var header = {\n    control: (buffer.peekUInt8() & 0x80) === 0x80,\n    version: null,\n    type: null,\n    id: null,\n    flags: null,\n    length: null\n  }\n\n  if (header.control) {\n    header.version = buffer.readUInt16BE() & 0x7fff\n    header.type = buffer.readUInt16BE()\n  } else {\n    header.id = buffer.readUInt32BE(0) & 0x7fffffff\n  }\n  header.flags = buffer.readUInt8()\n  header.length = buffer.readUInt24BE()\n\n  if (this.version === null && header.control) {\n    // TODO(indutny): do ProtocolError here and in the rest of errors\n    if (header.version !== 2 && header.version !== 3) {\n      return callback(new Error('Unsupported SPDY version: ' + header.version))\n    }\n    this.setVersion(header.version)\n  }\n\n  this.state = 'frame-body'\n  this.waiting = header.length\n  this.pendingHeader = header\n  this.partial = !header.control\n\n  callback(null, null)\n}\n\nParser.prototype.onFrameBody = function onFrameBody (header, buffer, callback) {\n  // Data frame\n  if (!header.control) {\n    // Count received bytes\n    if (this.window) {\n      this.window.recv.update(-buffer.size)\n    }\n\n    // No support for compressed DATA\n    if ((header.flags & constants.flags.FLAG_COMPRESSED) !== 0) {\n      return callback(new Error('DATA compression not supported'))\n    }\n\n    if (header.id === 0) {\n      return callback(this.error(constants.error.PROTOCOL_ERROR,\n        'Invalid stream id for DATA'))\n    }\n\n    return callback(null, {\n      type: 'DATA',\n      id: header.id,\n      fin: (header.flags & constants.flags.FLAG_FIN) !== 0,\n      data: buffer.take(buffer.size)\n    })\n  }\n\n  if (header.type === 0x01 || header.type === 0x02) { // SYN_STREAM or SYN_REPLY\n    this.onSynHeadFrame(header.type, header.flags, buffer, callback)\n  } else if (header.type === 0x03) { // RST_STREAM\n    this.onRSTFrame(buffer, callback)\n  } else if (header.type === 0x04) { // SETTINGS\n    this.onSettingsFrame(buffer, callback)\n  } else if (header.type === 0x05) {\n    callback(null, { type: 'NOOP' })\n  } else if (header.type === 0x06) { // PING\n    this.onPingFrame(buffer, callback)\n  } else if (header.type === 0x07) { // GOAWAY\n    this.onGoawayFrame(buffer, callback)\n  } else if (header.type === 0x08) { // HEADERS\n    this.onHeaderFrames(buffer, callback)\n  } else if (header.type === 0x09) { // WINDOW_UPDATE\n    this.onWindowUpdateFrame(buffer, callback)\n  } else if (header.type === 0xf000) { // X-FORWARDED\n    this.onXForwardedFrame(buffer, callback)\n  } else {\n    callback(null, { type: 'unknown: ' + header.type })\n  }\n}\n\nParser.prototype._filterHeader = function _filterHeader (headers, name) {\n  var res = {}\n  var keys = Object.keys(headers)\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i]\n    if (key !== name) {\n      res[key] = headers[key]\n    }\n  }\n\n  return res\n}\n\nParser.prototype.onSynHeadFrame = function onSynHeadFrame (type,\n  flags,\n  body,\n  callback) {\n  var self = this\n  var stream = type === 0x01\n  var offset = stream ? 10 : this.version === 2 ? 6 : 4\n\n  if (!body.has(offset)) {\n    return callback(new Error('SynHead OOB'))\n  }\n\n  var head = body.clone(offset)\n  body.skip(offset)\n  this.parseKVs(body, function (err, headers) {\n    if (err) {\n      return callback(err)\n    }\n\n    if (stream &&\n        (!headers[':method'] || !headers[':path'])) {\n      return callback(new Error('Missing `:method` and/or `:path` header'))\n    }\n\n    var id = head.readUInt32BE() & 0x7fffffff\n\n    if (id === 0) {\n      return callback(self.error(constants.error.PROTOCOL_ERROR,\n        'Invalid stream id for HEADERS'))\n    }\n\n    var associated = stream ? head.readUInt32BE() & 0x7fffffff : 0\n    var priority = stream\n      ? head.readUInt8() >> 5\n      : utils.weightToPriority(constants.DEFAULT_WEIGHT)\n    var fin = (flags & constants.flags.FLAG_FIN) !== 0\n    var unidir = (flags & constants.flags.FLAG_UNIDIRECTIONAL) !== 0\n    var path = headers[':path']\n\n    var isPush = stream && associated !== 0\n\n    var weight = utils.priorityToWeight(priority)\n    var priorityInfo = {\n      weight: weight,\n      exclusive: false,\n      parent: 0\n    }\n\n    if (!isPush) {\n      callback(null, {\n        type: 'HEADERS',\n        id: id,\n        priority: priorityInfo,\n        fin: fin,\n        writable: !unidir,\n        headers: headers,\n        path: path\n      })\n      return\n    }\n\n    if (stream && !headers[':status']) {\n      return callback(new Error('Missing `:status` header'))\n    }\n\n    var filteredHeaders = self._filterHeader(headers, ':status')\n\n    callback(null, [ {\n      type: 'PUSH_PROMISE',\n      id: associated,\n      fin: false,\n      promisedId: id,\n      headers: filteredHeaders,\n      path: path\n    }, {\n      type: 'HEADERS',\n      id: id,\n      fin: fin,\n      priority: priorityInfo,\n      writable: true,\n      path: undefined,\n      headers: {\n        ':status': headers[':status']\n      }\n    }])\n  })\n}\n\nParser.prototype.onHeaderFrames = function onHeaderFrames (body, callback) {\n  var offset = this.version === 2 ? 6 : 4\n  if (!body.has(offset)) {\n    return callback(new Error('HEADERS OOB'))\n  }\n\n  var streamId = body.readUInt32BE() & 0x7fffffff\n  if (this.version === 2) { body.skip(2) }\n\n  this.parseKVs(body, function (err, headers) {\n    if (err) { return callback(err) }\n\n    callback(null, {\n      type: 'HEADERS',\n      priority: {\n        parent: 0,\n        exclusive: false,\n        weight: constants.DEFAULT_WEIGHT\n      },\n      id: streamId,\n      fin: false,\n      writable: true,\n      path: undefined,\n      headers: headers\n    })\n  })\n}\n\nParser.prototype.parseKVs = function parseKVs (buffer, callback) {\n  var self = this\n\n  this.decompress.write(buffer.toChunks(), function (err, chunks) {\n    if (err) {\n      return callback(err)\n    }\n\n    var buffer = new OffsetBuffer()\n    for (var i = 0; i < chunks.length; i++) {\n      buffer.push(chunks[i])\n    }\n\n    var size = self.version === 2 ? 2 : 4\n    if (!buffer.has(size)) { return callback(new Error('KV OOB')) }\n\n    var count = self.version === 2\n      ? buffer.readUInt16BE()\n      : buffer.readUInt32BE()\n\n    var headers = {}\n\n    function readString () {\n      if (!buffer.has(size)) { return null }\n      var len = self.version === 2\n        ? buffer.readUInt16BE()\n        : buffer.readUInt32BE()\n\n      if (!buffer.has(len)) { return null }\n\n      var value = buffer.take(len)\n      return value.toString()\n    }\n\n    while (count > 0) {\n      var key = readString()\n      var value = readString()\n\n      if (key === null || value === null) {\n        return callback(new Error('Headers OOB'))\n      }\n\n      if (self.version < 3) {\n        var isInternal = /^(method|version|url|host|scheme|status)$/.test(key)\n        if (key === 'url') {\n          key = 'path'\n        }\n        if (isInternal) {\n          key = ':' + key\n        }\n      }\n\n      // Compatibility with HTTP2\n      if (key === ':status') {\n        value = value.split(/ /g, 2)[0]\n      }\n\n      count--\n      if (key === ':host') {\n        key = ':authority'\n      }\n\n      // Skip version, not present in HTTP2\n      if (key === ':version') {\n        continue\n      }\n\n      value = value.split(/\\0/g)\n      for (var j = 0; j < value.length; j++) {\n        utils.addHeaderLine(key, value[j], headers)\n      }\n    }\n\n    callback(null, headers)\n  })\n}\n\nParser.prototype.onRSTFrame = function onRSTFrame (body, callback) {\n  if (!body.has(8)) { return callback(new Error('RST OOB')) }\n\n  var frame = {\n    type: 'RST',\n    id: body.readUInt32BE() & 0x7fffffff,\n    code: constants.errorByCode[body.readUInt32BE()]\n  }\n\n  if (frame.id === 0) {\n    return callback(this.error(constants.error.PROTOCOL_ERROR,\n      'Invalid stream id for RST'))\n  }\n\n  if (body.size !== 0) {\n    frame.extra = body.take(body.size)\n  }\n  callback(null, frame)\n}\n\nParser.prototype.onSettingsFrame = function onSettingsFrame (body, callback) {\n  if (!body.has(4)) {\n    return callback(new Error('SETTINGS OOB'))\n  }\n\n  var settings = {}\n  var number = body.readUInt32BE()\n  var idMap = {\n    1: 'upload_bandwidth',\n    2: 'download_bandwidth',\n    3: 'round_trip_time',\n    4: 'max_concurrent_streams',\n    5: 'current_cwnd',\n    6: 'download_retrans_rate',\n    7: 'initial_window_size',\n    8: 'client_certificate_vector_size'\n  }\n\n  if (!body.has(number * 8)) {\n    return callback(new Error('SETTINGS OOB#2'))\n  }\n\n  for (var i = 0; i < number; i++) {\n    var id = this.version === 2\n      ? body.readUInt32LE()\n      : body.readUInt32BE()\n\n    var flags = (id >> 24) & 0xff\n    id = id & 0xffffff\n\n    // Skip persisted settings\n    if (flags & 0x2) { continue }\n\n    var name = idMap[id]\n\n    settings[name] = body.readUInt32BE()\n  }\n\n  callback(null, {\n    type: 'SETTINGS',\n    settings: settings\n  })\n}\n\nParser.prototype.onPingFrame = function onPingFrame (body, callback) {\n  if (!body.has(4)) {\n    return callback(new Error('PING OOB'))\n  }\n\n  var isServer = this.isServer\n  var opaque = body.clone(body.size).take(body.size)\n  var id = body.readUInt32BE()\n  var ack = isServer ? (id % 2 === 0) : (id % 2 === 1)\n\n  callback(null, { type: 'PING', opaque: opaque, ack: ack })\n}\n\nParser.prototype.onGoawayFrame = function onGoawayFrame (body, callback) {\n  if (!body.has(8)) {\n    return callback(new Error('GOAWAY OOB'))\n  }\n\n  callback(null, {\n    type: 'GOAWAY',\n    lastId: body.readUInt32BE() & 0x7fffffff,\n    code: constants.goawayByCode[body.readUInt32BE()]\n  })\n}\n\nParser.prototype.onWindowUpdateFrame = function onWindowUpdateFrame (body,\n  callback) {\n  if (!body.has(8)) {\n    return callback(new Error('WINDOW_UPDATE OOB'))\n  }\n\n  callback(null, {\n    type: 'WINDOW_UPDATE',\n    id: body.readUInt32BE() & 0x7fffffff,\n    delta: body.readInt32BE()\n  })\n}\n\nParser.prototype.onXForwardedFrame = function onXForwardedFrame (body,\n  callback) {\n  if (!body.has(4)) {\n    return callback(new Error('X_FORWARDED OOB'))\n  }\n\n  var len = body.readUInt32BE()\n  if (!body.has(len)) { return callback(new Error('X_FORWARDED host length OOB')) }\n\n  callback(null, {\n    type: 'X_FORWARDED_FOR',\n    host: body.take(len).toString()\n  })\n}\n"],"mappings":"AAAA,YAAY;;AAEZ,IAAIA,MAAM,GAAGC,OAAO;AAEpB,IAAIC,SAAS,GAAGC,OAAO,CAAC,yBAAyB,CAAC;AAClD,IAAIC,IAAI,GAAGF,SAAS,CAACG,QAAQ,CAACD,IAAI;AAClC,IAAIE,KAAK,GAAGF,IAAI,CAACE,KAAK;AACtB,IAAIC,SAAS,GAAGJ,OAAO,CAAC,aAAa,CAAC;AAEtC,IAAIK,MAAM,GAAGL,OAAO,CAAC,QAAQ,CAAC;AAC9B,IAAIM,IAAI,GAAGN,OAAO,CAAC,MAAM,CAAC;AAC1B,IAAIO,YAAY,GAAGP,OAAO,CAAC,MAAM,CAAC;AAElC,SAASQ,MAAM,CAAEC,OAAO,EAAE;EACxBR,IAAI,CAACO,MAAM,CAACE,IAAI,CAAC,IAAI,EAAED,OAAO,CAAC;EAE/B,IAAI,CAACE,QAAQ,GAAGF,OAAO,CAACE,QAAQ;EAChC,IAAI,CAACC,OAAO,GAAGR,SAAS,CAACS,iBAAiB;EAC1C,IAAI,CAACC,KAAK,GAAG,YAAY;EACzB,IAAI,CAACC,aAAa,GAAG,IAAI;AAC3B;AACAT,IAAI,CAACU,QAAQ,CAACR,MAAM,EAAEP,IAAI,CAACO,MAAM,CAAC;AAElCX,MAAM,CAACoB,MAAM,GAAG,SAASA,MAAM,CAAER,OAAO,EAAE;EACxC,OAAO,IAAID,MAAM,CAACC,OAAO,CAAC;AAC5B,CAAC;AAEDD,MAAM,CAACU,SAAS,CAACC,eAAe,GAAG,SAASA,eAAe,CAAEC,IAAI,EAAE;EACjE;AAAA,CACD;AAEDZ,MAAM,CAACU,SAAS,CAACG,oBAAoB,GAAG,SAASA,oBAAoB,CAAED,IAAI,EAAE;EAC3E;AAAA,CACD;;AAED;AACAZ,MAAM,CAACU,SAAS,CAACI,WAAW,GAAG,SAASA,WAAW,GAAI,CACvD,CAAC;AAEDd,MAAM,CAACU,SAAS,CAACK,OAAO,GAAG,SAASA,OAAO,CAAEC,MAAM,EAAEC,QAAQ,EAAE;EAC7D,IAAI,IAAI,CAACX,KAAK,KAAK,YAAY,EAAE;IAAE,OAAO,IAAI,CAACY,WAAW,CAACF,MAAM,EAAEC,QAAQ,CAAC;EAAC;EAE7EpB,MAAM,CAAC,IAAI,CAACS,KAAK,KAAK,YAAY,IAAI,IAAI,CAACC,aAAa,KAAK,IAAI,CAAC;EAElE,IAAIY,IAAI,GAAG,IAAI;EACf,IAAIC,MAAM,GAAG,IAAI,CAACb,aAAa;EAC/B,IAAI,CAACA,aAAa,GAAG,IAAI;EAEzB,IAAI,CAACc,WAAW,CAACD,MAAM,EAAEJ,MAAM,EAAE,UAAUM,GAAG,EAAEC,KAAK,EAAE;IACrD,IAAID,GAAG,EAAE;MACP,OAAOL,QAAQ,CAACK,GAAG,CAAC;IACtB;IAEAH,IAAI,CAACb,KAAK,GAAG,YAAY;IACzBa,IAAI,CAACf,OAAO,GAAGR,SAAS,CAACS,iBAAiB;IAC1Cc,IAAI,CAACK,OAAO,GAAG,KAAK;IACpBP,QAAQ,CAAC,IAAI,EAAEM,KAAK,CAAC;EACvB,CAAC,CAAC;AACJ,CAAC;AAEDvB,MAAM,CAACU,SAAS,CAACe,cAAc,GAAG,SAASA,cAAc,CAAET,MAAM,EAAEC,QAAQ,EAAE;EAC3E,IAAIG,MAAM,GAAG,IAAI,CAACb,aAAa;EAE/B,IAAI,IAAI,CAACmB,MAAM,EAAE;IACf,IAAI,CAACA,MAAM,CAACC,IAAI,CAACC,MAAM,CAAC,CAACZ,MAAM,CAACJ,IAAI,CAAC;EACvC;;EAEA;EACAK,QAAQ,CAAC,IAAI,EAAE;IACbY,IAAI,EAAE,MAAM;IACZC,EAAE,EAAEV,MAAM,CAACU,EAAE;IAEb;IACAC,GAAG,EAAE,KAAK;IACVC,IAAI,EAAEhB,MAAM,CAACiB,IAAI,CAACjB,MAAM,CAACJ,IAAI;EAC/B,CAAC,CAAC;AACJ,CAAC;AAEDZ,MAAM,CAACU,SAAS,CAACQ,WAAW,GAAG,SAASA,WAAW,CAAEF,MAAM,EAAEC,QAAQ,EAAE;EACrE,IAAIG,MAAM,GAAG;IACXc,OAAO,EAAE,CAAClB,MAAM,CAACmB,SAAS,EAAE,GAAG,IAAI,MAAM,IAAI;IAC7CC,OAAO,EAAE,IAAI;IACbP,IAAI,EAAE,IAAI;IACVC,EAAE,EAAE,IAAI;IACRO,KAAK,EAAE,IAAI;IACXC,MAAM,EAAE;EACV,CAAC;EAED,IAAIlB,MAAM,CAACc,OAAO,EAAE;IAClBd,MAAM,CAACgB,OAAO,GAAGpB,MAAM,CAACuB,YAAY,EAAE,GAAG,MAAM;IAC/CnB,MAAM,CAACS,IAAI,GAAGb,MAAM,CAACuB,YAAY,EAAE;EACrC,CAAC,MAAM;IACLnB,MAAM,CAACU,EAAE,GAAGd,MAAM,CAACwB,YAAY,CAAC,CAAC,CAAC,GAAG,UAAU;EACjD;EACApB,MAAM,CAACiB,KAAK,GAAGrB,MAAM,CAACyB,SAAS,EAAE;EACjCrB,MAAM,CAACkB,MAAM,GAAGtB,MAAM,CAAC0B,YAAY,EAAE;EAErC,IAAI,IAAI,CAACN,OAAO,KAAK,IAAI,IAAIhB,MAAM,CAACc,OAAO,EAAE;IAC3C;IACA,IAAId,MAAM,CAACgB,OAAO,KAAK,CAAC,IAAIhB,MAAM,CAACgB,OAAO,KAAK,CAAC,EAAE;MAChD,OAAOnB,QAAQ,CAAC,IAAI0B,KAAK,CAAC,4BAA4B,GAAGvB,MAAM,CAACgB,OAAO,CAAC,CAAC;IAC3E;IACA,IAAI,CAACQ,UAAU,CAACxB,MAAM,CAACgB,OAAO,CAAC;EACjC;EAEA,IAAI,CAAC9B,KAAK,GAAG,YAAY;EACzB,IAAI,CAACF,OAAO,GAAGgB,MAAM,CAACkB,MAAM;EAC5B,IAAI,CAAC/B,aAAa,GAAGa,MAAM;EAC3B,IAAI,CAACI,OAAO,GAAG,CAACJ,MAAM,CAACc,OAAO;EAE9BjB,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC;AACtB,CAAC;AAEDjB,MAAM,CAACU,SAAS,CAACW,WAAW,GAAG,SAASA,WAAW,CAAED,MAAM,EAAEJ,MAAM,EAAEC,QAAQ,EAAE;EAC7E;EACA,IAAI,CAACG,MAAM,CAACc,OAAO,EAAE;IACnB;IACA,IAAI,IAAI,CAACR,MAAM,EAAE;MACf,IAAI,CAACA,MAAM,CAACC,IAAI,CAACC,MAAM,CAAC,CAACZ,MAAM,CAACJ,IAAI,CAAC;IACvC;;IAEA;IACA,IAAI,CAACQ,MAAM,CAACiB,KAAK,GAAGzC,SAAS,CAACyC,KAAK,CAACQ,eAAe,MAAM,CAAC,EAAE;MAC1D,OAAO5B,QAAQ,CAAC,IAAI0B,KAAK,CAAC,gCAAgC,CAAC,CAAC;IAC9D;IAEA,IAAIvB,MAAM,CAACU,EAAE,KAAK,CAAC,EAAE;MACnB,OAAOb,QAAQ,CAAC,IAAI,CAAC6B,KAAK,CAAClD,SAAS,CAACkD,KAAK,CAACC,cAAc,EACvD,4BAA4B,CAAC,CAAC;IAClC;IAEA,OAAO9B,QAAQ,CAAC,IAAI,EAAE;MACpBY,IAAI,EAAE,MAAM;MACZC,EAAE,EAAEV,MAAM,CAACU,EAAE;MACbC,GAAG,EAAE,CAACX,MAAM,CAACiB,KAAK,GAAGzC,SAAS,CAACyC,KAAK,CAACW,QAAQ,MAAM,CAAC;MACpDhB,IAAI,EAAEhB,MAAM,CAACiB,IAAI,CAACjB,MAAM,CAACJ,IAAI;IAC/B,CAAC,CAAC;EACJ;EAEA,IAAIQ,MAAM,CAACS,IAAI,KAAK,IAAI,IAAIT,MAAM,CAACS,IAAI,KAAK,IAAI,EAAE;IAAE;IAClD,IAAI,CAACoB,cAAc,CAAC7B,MAAM,CAACS,IAAI,EAAET,MAAM,CAACiB,KAAK,EAAErB,MAAM,EAAEC,QAAQ,CAAC;EAClE,CAAC,MAAM,IAAIG,MAAM,CAACS,IAAI,KAAK,IAAI,EAAE;IAAE;IACjC,IAAI,CAACqB,UAAU,CAAClC,MAAM,EAAEC,QAAQ,CAAC;EACnC,CAAC,MAAM,IAAIG,MAAM,CAACS,IAAI,KAAK,IAAI,EAAE;IAAE;IACjC,IAAI,CAACsB,eAAe,CAACnC,MAAM,EAAEC,QAAQ,CAAC;EACxC,CAAC,MAAM,IAAIG,MAAM,CAACS,IAAI,KAAK,IAAI,EAAE;IAC/BZ,QAAQ,CAAC,IAAI,EAAE;MAAEY,IAAI,EAAE;IAAO,CAAC,CAAC;EAClC,CAAC,MAAM,IAAIT,MAAM,CAACS,IAAI,KAAK,IAAI,EAAE;IAAE;IACjC,IAAI,CAACuB,WAAW,CAACpC,MAAM,EAAEC,QAAQ,CAAC;EACpC,CAAC,MAAM,IAAIG,MAAM,CAACS,IAAI,KAAK,IAAI,EAAE;IAAE;IACjC,IAAI,CAACwB,aAAa,CAACrC,MAAM,EAAEC,QAAQ,CAAC;EACtC,CAAC,MAAM,IAAIG,MAAM,CAACS,IAAI,KAAK,IAAI,EAAE;IAAE;IACjC,IAAI,CAACyB,cAAc,CAACtC,MAAM,EAAEC,QAAQ,CAAC;EACvC,CAAC,MAAM,IAAIG,MAAM,CAACS,IAAI,KAAK,IAAI,EAAE;IAAE;IACjC,IAAI,CAAC0B,mBAAmB,CAACvC,MAAM,EAAEC,QAAQ,CAAC;EAC5C,CAAC,MAAM,IAAIG,MAAM,CAACS,IAAI,KAAK,MAAM,EAAE;IAAE;IACnC,IAAI,CAAC2B,iBAAiB,CAACxC,MAAM,EAAEC,QAAQ,CAAC;EAC1C,CAAC,MAAM;IACLA,QAAQ,CAAC,IAAI,EAAE;MAAEY,IAAI,EAAE,WAAW,GAAGT,MAAM,CAACS;IAAK,CAAC,CAAC;EACrD;AACF,CAAC;AAED7B,MAAM,CAACU,SAAS,CAAC+C,aAAa,GAAG,SAASA,aAAa,CAAEC,OAAO,EAAEC,IAAI,EAAE;EACtE,IAAIC,GAAG,GAAG,CAAC,CAAC;EACZ,IAAIC,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACH,OAAO,CAAC;EAE/B,KAAK,IAAIK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,IAAI,CAACvB,MAAM,EAAEyB,CAAC,EAAE,EAAE;IACpC,IAAIC,GAAG,GAAGH,IAAI,CAACE,CAAC,CAAC;IACjB,IAAIC,GAAG,KAAKL,IAAI,EAAE;MAChBC,GAAG,CAACI,GAAG,CAAC,GAAGN,OAAO,CAACM,GAAG,CAAC;IACzB;EACF;EAEA,OAAOJ,GAAG;AACZ,CAAC;AAED5D,MAAM,CAACU,SAAS,CAACuC,cAAc,GAAG,SAASA,cAAc,CAAEpB,IAAI,EAC7DQ,KAAK,EACL4B,IAAI,EACJhD,QAAQ,EAAE;EACV,IAAIE,IAAI,GAAG,IAAI;EACf,IAAI+C,MAAM,GAAGrC,IAAI,KAAK,IAAI;EAC1B,IAAIsC,MAAM,GAAGD,MAAM,GAAG,EAAE,GAAG,IAAI,CAAC9B,OAAO,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC;EAErD,IAAI,CAAC6B,IAAI,CAACG,GAAG,CAACD,MAAM,CAAC,EAAE;IACrB,OAAOlD,QAAQ,CAAC,IAAI0B,KAAK,CAAC,aAAa,CAAC,CAAC;EAC3C;EAEA,IAAI0B,IAAI,GAAGJ,IAAI,CAACK,KAAK,CAACH,MAAM,CAAC;EAC7BF,IAAI,CAACM,IAAI,CAACJ,MAAM,CAAC;EACjB,IAAI,CAACK,QAAQ,CAACP,IAAI,EAAE,UAAU3C,GAAG,EAAEoC,OAAO,EAAE;IAC1C,IAAIpC,GAAG,EAAE;MACP,OAAOL,QAAQ,CAACK,GAAG,CAAC;IACtB;IAEA,IAAI4C,MAAM,KACL,CAACR,OAAO,CAAC,SAAS,CAAC,IAAI,CAACA,OAAO,CAAC,OAAO,CAAC,CAAC,EAAE;MAC9C,OAAOzC,QAAQ,CAAC,IAAI0B,KAAK,CAAC,yCAAyC,CAAC,CAAC;IACvE;IAEA,IAAIb,EAAE,GAAGuC,IAAI,CAAC7B,YAAY,EAAE,GAAG,UAAU;IAEzC,IAAIV,EAAE,KAAK,CAAC,EAAE;MACZ,OAAOb,QAAQ,CAACE,IAAI,CAAC2B,KAAK,CAAClD,SAAS,CAACkD,KAAK,CAACC,cAAc,EACvD,+BAA+B,CAAC,CAAC;IACrC;IAEA,IAAI0B,UAAU,GAAGP,MAAM,GAAGG,IAAI,CAAC7B,YAAY,EAAE,GAAG,UAAU,GAAG,CAAC;IAC9D,IAAIkC,QAAQ,GAAGR,MAAM,GACjBG,IAAI,CAAC5B,SAAS,EAAE,IAAI,CAAC,GACrB9C,KAAK,CAACgF,gBAAgB,CAAC/E,SAAS,CAACgF,cAAc,CAAC;IACpD,IAAI7C,GAAG,GAAG,CAACM,KAAK,GAAGzC,SAAS,CAACyC,KAAK,CAACW,QAAQ,MAAM,CAAC;IAClD,IAAI6B,MAAM,GAAG,CAACxC,KAAK,GAAGzC,SAAS,CAACyC,KAAK,CAACyC,mBAAmB,MAAM,CAAC;IAChE,IAAIC,IAAI,GAAGrB,OAAO,CAAC,OAAO,CAAC;IAE3B,IAAIsB,MAAM,GAAGd,MAAM,IAAIO,UAAU,KAAK,CAAC;IAEvC,IAAIQ,MAAM,GAAGtF,KAAK,CAACuF,gBAAgB,CAACR,QAAQ,CAAC;IAC7C,IAAIS,YAAY,GAAG;MACjBF,MAAM,EAAEA,MAAM;MACdG,SAAS,EAAE,KAAK;MAChBC,MAAM,EAAE;IACV,CAAC;IAED,IAAI,CAACL,MAAM,EAAE;MACX/D,QAAQ,CAAC,IAAI,EAAE;QACbY,IAAI,EAAE,SAAS;QACfC,EAAE,EAAEA,EAAE;QACN4C,QAAQ,EAAES,YAAY;QACtBpD,GAAG,EAAEA,GAAG;QACRuD,QAAQ,EAAE,CAACT,MAAM;QACjBnB,OAAO,EAAEA,OAAO;QAChBqB,IAAI,EAAEA;MACR,CAAC,CAAC;MACF;IACF;IAEA,IAAIb,MAAM,IAAI,CAACR,OAAO,CAAC,SAAS,CAAC,EAAE;MACjC,OAAOzC,QAAQ,CAAC,IAAI0B,KAAK,CAAC,0BAA0B,CAAC,CAAC;IACxD;IAEA,IAAI4C,eAAe,GAAGpE,IAAI,CAACsC,aAAa,CAACC,OAAO,EAAE,SAAS,CAAC;IAE5DzC,QAAQ,CAAC,IAAI,EAAE,CAAE;MACfY,IAAI,EAAE,cAAc;MACpBC,EAAE,EAAE2C,UAAU;MACd1C,GAAG,EAAE,KAAK;MACVyD,UAAU,EAAE1D,EAAE;MACd4B,OAAO,EAAE6B,eAAe;MACxBR,IAAI,EAAEA;IACR,CAAC,EAAE;MACDlD,IAAI,EAAE,SAAS;MACfC,EAAE,EAAEA,EAAE;MACNC,GAAG,EAAEA,GAAG;MACR2C,QAAQ,EAAES,YAAY;MACtBG,QAAQ,EAAE,IAAI;MACdP,IAAI,EAAEU,SAAS;MACf/B,OAAO,EAAE;QACP,SAAS,EAAEA,OAAO,CAAC,SAAS;MAC9B;IACF,CAAC,CAAC,CAAC;EACL,CAAC,CAAC;AACJ,CAAC;AAED1D,MAAM,CAACU,SAAS,CAAC4C,cAAc,GAAG,SAASA,cAAc,CAAEW,IAAI,EAAEhD,QAAQ,EAAE;EACzE,IAAIkD,MAAM,GAAG,IAAI,CAAC/B,OAAO,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC;EACvC,IAAI,CAAC6B,IAAI,CAACG,GAAG,CAACD,MAAM,CAAC,EAAE;IACrB,OAAOlD,QAAQ,CAAC,IAAI0B,KAAK,CAAC,aAAa,CAAC,CAAC;EAC3C;EAEA,IAAI+C,QAAQ,GAAGzB,IAAI,CAACzB,YAAY,EAAE,GAAG,UAAU;EAC/C,IAAI,IAAI,CAACJ,OAAO,KAAK,CAAC,EAAE;IAAE6B,IAAI,CAACM,IAAI,CAAC,CAAC,CAAC;EAAC;EAEvC,IAAI,CAACC,QAAQ,CAACP,IAAI,EAAE,UAAU3C,GAAG,EAAEoC,OAAO,EAAE;IAC1C,IAAIpC,GAAG,EAAE;MAAE,OAAOL,QAAQ,CAACK,GAAG,CAAC;IAAC;IAEhCL,QAAQ,CAAC,IAAI,EAAE;MACbY,IAAI,EAAE,SAAS;MACf6C,QAAQ,EAAE;QACRW,MAAM,EAAE,CAAC;QACTD,SAAS,EAAE,KAAK;QAChBH,MAAM,EAAErF,SAAS,CAACgF;MACpB,CAAC;MACD9C,EAAE,EAAE4D,QAAQ;MACZ3D,GAAG,EAAE,KAAK;MACVuD,QAAQ,EAAE,IAAI;MACdP,IAAI,EAAEU,SAAS;MACf/B,OAAO,EAAEA;IACX,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAED1D,MAAM,CAACU,SAAS,CAAC8D,QAAQ,GAAG,SAASA,QAAQ,CAAExD,MAAM,EAAEC,QAAQ,EAAE;EAC/D,IAAIE,IAAI,GAAG,IAAI;EAEf,IAAI,CAACwE,UAAU,CAACC,KAAK,CAAC5E,MAAM,CAAC6E,QAAQ,EAAE,EAAE,UAAUvE,GAAG,EAAEwE,MAAM,EAAE;IAC9D,IAAIxE,GAAG,EAAE;MACP,OAAOL,QAAQ,CAACK,GAAG,CAAC;IACtB;IAEA,IAAIN,MAAM,GAAG,IAAIjB,YAAY,EAAE;IAC/B,KAAK,IAAIgE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+B,MAAM,CAACxD,MAAM,EAAEyB,CAAC,EAAE,EAAE;MACtC/C,MAAM,CAAC+E,IAAI,CAACD,MAAM,CAAC/B,CAAC,CAAC,CAAC;IACxB;IAEA,IAAInD,IAAI,GAAGO,IAAI,CAACiB,OAAO,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC;IACrC,IAAI,CAACpB,MAAM,CAACoD,GAAG,CAACxD,IAAI,CAAC,EAAE;MAAE,OAAOK,QAAQ,CAAC,IAAI0B,KAAK,CAAC,QAAQ,CAAC,CAAC;IAAC;IAE9D,IAAIqD,KAAK,GAAG7E,IAAI,CAACiB,OAAO,KAAK,CAAC,GAC1BpB,MAAM,CAACuB,YAAY,EAAE,GACrBvB,MAAM,CAACwB,YAAY,EAAE;IAEzB,IAAIkB,OAAO,GAAG,CAAC,CAAC;IAEhB,SAASuC,UAAU,GAAI;MACrB,IAAI,CAACjF,MAAM,CAACoD,GAAG,CAACxD,IAAI,CAAC,EAAE;QAAE,OAAO,IAAI;MAAC;MACrC,IAAIsF,GAAG,GAAG/E,IAAI,CAACiB,OAAO,KAAK,CAAC,GACxBpB,MAAM,CAACuB,YAAY,EAAE,GACrBvB,MAAM,CAACwB,YAAY,EAAE;MAEzB,IAAI,CAACxB,MAAM,CAACoD,GAAG,CAAC8B,GAAG,CAAC,EAAE;QAAE,OAAO,IAAI;MAAC;MAEpC,IAAIC,KAAK,GAAGnF,MAAM,CAACiB,IAAI,CAACiE,GAAG,CAAC;MAC5B,OAAOC,KAAK,CAACC,QAAQ,EAAE;IACzB;IAEA,OAAOJ,KAAK,GAAG,CAAC,EAAE;MAChB,IAAIhC,GAAG,GAAGiC,UAAU,EAAE;MACtB,IAAIE,KAAK,GAAGF,UAAU,EAAE;MAExB,IAAIjC,GAAG,KAAK,IAAI,IAAImC,KAAK,KAAK,IAAI,EAAE;QAClC,OAAOlF,QAAQ,CAAC,IAAI0B,KAAK,CAAC,aAAa,CAAC,CAAC;MAC3C;MAEA,IAAIxB,IAAI,CAACiB,OAAO,GAAG,CAAC,EAAE;QACpB,IAAIiE,UAAU,GAAG,2CAA2C,CAACC,IAAI,CAACtC,GAAG,CAAC;QACtE,IAAIA,GAAG,KAAK,KAAK,EAAE;UACjBA,GAAG,GAAG,MAAM;QACd;QACA,IAAIqC,UAAU,EAAE;UACdrC,GAAG,GAAG,GAAG,GAAGA,GAAG;QACjB;MACF;;MAEA;MACA,IAAIA,GAAG,KAAK,SAAS,EAAE;QACrBmC,KAAK,GAAGA,KAAK,CAACI,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;MACjC;MAEAP,KAAK,EAAE;MACP,IAAIhC,GAAG,KAAK,OAAO,EAAE;QACnBA,GAAG,GAAG,YAAY;MACpB;;MAEA;MACA,IAAIA,GAAG,KAAK,UAAU,EAAE;QACtB;MACF;MAEAmC,KAAK,GAAGA,KAAK,CAACI,KAAK,CAAC,KAAK,CAAC;MAC1B,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGL,KAAK,CAAC7D,MAAM,EAAEkE,CAAC,EAAE,EAAE;QACrC7G,KAAK,CAAC8G,aAAa,CAACzC,GAAG,EAAEmC,KAAK,CAACK,CAAC,CAAC,EAAE9C,OAAO,CAAC;MAC7C;IACF;IAEAzC,QAAQ,CAAC,IAAI,EAAEyC,OAAO,CAAC;EACzB,CAAC,CAAC;AACJ,CAAC;AAED1D,MAAM,CAACU,SAAS,CAACwC,UAAU,GAAG,SAASA,UAAU,CAAEe,IAAI,EAAEhD,QAAQ,EAAE;EACjE,IAAI,CAACgD,IAAI,CAACG,GAAG,CAAC,CAAC,CAAC,EAAE;IAAE,OAAOnD,QAAQ,CAAC,IAAI0B,KAAK,CAAC,SAAS,CAAC,CAAC;EAAC;EAE1D,IAAIpB,KAAK,GAAG;IACVM,IAAI,EAAE,KAAK;IACXC,EAAE,EAAEmC,IAAI,CAACzB,YAAY,EAAE,GAAG,UAAU;IACpCkE,IAAI,EAAE9G,SAAS,CAAC+G,WAAW,CAAC1C,IAAI,CAACzB,YAAY,EAAE;EACjD,CAAC;EAED,IAAIjB,KAAK,CAACO,EAAE,KAAK,CAAC,EAAE;IAClB,OAAOb,QAAQ,CAAC,IAAI,CAAC6B,KAAK,CAAClD,SAAS,CAACkD,KAAK,CAACC,cAAc,EACvD,2BAA2B,CAAC,CAAC;EACjC;EAEA,IAAIkB,IAAI,CAACrD,IAAI,KAAK,CAAC,EAAE;IACnBW,KAAK,CAACqF,KAAK,GAAG3C,IAAI,CAAChC,IAAI,CAACgC,IAAI,CAACrD,IAAI,CAAC;EACpC;EACAK,QAAQ,CAAC,IAAI,EAAEM,KAAK,CAAC;AACvB,CAAC;AAEDvB,MAAM,CAACU,SAAS,CAACyC,eAAe,GAAG,SAASA,eAAe,CAAEc,IAAI,EAAEhD,QAAQ,EAAE;EAC3E,IAAI,CAACgD,IAAI,CAACG,GAAG,CAAC,CAAC,CAAC,EAAE;IAChB,OAAOnD,QAAQ,CAAC,IAAI0B,KAAK,CAAC,cAAc,CAAC,CAAC;EAC5C;EAEA,IAAIkE,QAAQ,GAAG,CAAC,CAAC;EACjB,IAAIC,MAAM,GAAG7C,IAAI,CAACzB,YAAY,EAAE;EAChC,IAAIuE,KAAK,GAAG;IACV,CAAC,EAAE,kBAAkB;IACrB,CAAC,EAAE,oBAAoB;IACvB,CAAC,EAAE,iBAAiB;IACpB,CAAC,EAAE,wBAAwB;IAC3B,CAAC,EAAE,cAAc;IACjB,CAAC,EAAE,uBAAuB;IAC1B,CAAC,EAAE,qBAAqB;IACxB,CAAC,EAAE;EACL,CAAC;EAED,IAAI,CAAC9C,IAAI,CAACG,GAAG,CAAC0C,MAAM,GAAG,CAAC,CAAC,EAAE;IACzB,OAAO7F,QAAQ,CAAC,IAAI0B,KAAK,CAAC,gBAAgB,CAAC,CAAC;EAC9C;EAEA,KAAK,IAAIoB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+C,MAAM,EAAE/C,CAAC,EAAE,EAAE;IAC/B,IAAIjC,EAAE,GAAG,IAAI,CAACM,OAAO,KAAK,CAAC,GACvB6B,IAAI,CAAC+C,YAAY,EAAE,GACnB/C,IAAI,CAACzB,YAAY,EAAE;IAEvB,IAAIH,KAAK,GAAIP,EAAE,IAAI,EAAE,GAAI,IAAI;IAC7BA,EAAE,GAAGA,EAAE,GAAG,QAAQ;;IAElB;IACA,IAAIO,KAAK,GAAG,GAAG,EAAE;MAAE;IAAS;IAE5B,IAAIsB,IAAI,GAAGoD,KAAK,CAACjF,EAAE,CAAC;IAEpB+E,QAAQ,CAAClD,IAAI,CAAC,GAAGM,IAAI,CAACzB,YAAY,EAAE;EACtC;EAEAvB,QAAQ,CAAC,IAAI,EAAE;IACbY,IAAI,EAAE,UAAU;IAChBgF,QAAQ,EAAEA;EACZ,CAAC,CAAC;AACJ,CAAC;AAED7G,MAAM,CAACU,SAAS,CAAC0C,WAAW,GAAG,SAASA,WAAW,CAAEa,IAAI,EAAEhD,QAAQ,EAAE;EACnE,IAAI,CAACgD,IAAI,CAACG,GAAG,CAAC,CAAC,CAAC,EAAE;IAChB,OAAOnD,QAAQ,CAAC,IAAI0B,KAAK,CAAC,UAAU,CAAC,CAAC;EACxC;EAEA,IAAIxC,QAAQ,GAAG,IAAI,CAACA,QAAQ;EAC5B,IAAI8G,MAAM,GAAGhD,IAAI,CAACK,KAAK,CAACL,IAAI,CAACrD,IAAI,CAAC,CAACqB,IAAI,CAACgC,IAAI,CAACrD,IAAI,CAAC;EAClD,IAAIkB,EAAE,GAAGmC,IAAI,CAACzB,YAAY,EAAE;EAC5B,IAAI0E,GAAG,GAAG/G,QAAQ,GAAI2B,EAAE,GAAG,CAAC,KAAK,CAAC,GAAKA,EAAE,GAAG,CAAC,KAAK,CAAE;EAEpDb,QAAQ,CAAC,IAAI,EAAE;IAAEY,IAAI,EAAE,MAAM;IAAEoF,MAAM,EAAEA,MAAM;IAAEC,GAAG,EAAEA;EAAI,CAAC,CAAC;AAC5D,CAAC;AAEDlH,MAAM,CAACU,SAAS,CAAC2C,aAAa,GAAG,SAASA,aAAa,CAAEY,IAAI,EAAEhD,QAAQ,EAAE;EACvE,IAAI,CAACgD,IAAI,CAACG,GAAG,CAAC,CAAC,CAAC,EAAE;IAChB,OAAOnD,QAAQ,CAAC,IAAI0B,KAAK,CAAC,YAAY,CAAC,CAAC;EAC1C;EAEA1B,QAAQ,CAAC,IAAI,EAAE;IACbY,IAAI,EAAE,QAAQ;IACdsF,MAAM,EAAElD,IAAI,CAACzB,YAAY,EAAE,GAAG,UAAU;IACxCkE,IAAI,EAAE9G,SAAS,CAACwH,YAAY,CAACnD,IAAI,CAACzB,YAAY,EAAE;EAClD,CAAC,CAAC;AACJ,CAAC;AAEDxC,MAAM,CAACU,SAAS,CAAC6C,mBAAmB,GAAG,SAASA,mBAAmB,CAAEU,IAAI,EACvEhD,QAAQ,EAAE;EACV,IAAI,CAACgD,IAAI,CAACG,GAAG,CAAC,CAAC,CAAC,EAAE;IAChB,OAAOnD,QAAQ,CAAC,IAAI0B,KAAK,CAAC,mBAAmB,CAAC,CAAC;EACjD;EAEA1B,QAAQ,CAAC,IAAI,EAAE;IACbY,IAAI,EAAE,eAAe;IACrBC,EAAE,EAAEmC,IAAI,CAACzB,YAAY,EAAE,GAAG,UAAU;IACpC6E,KAAK,EAAEpD,IAAI,CAACqD,WAAW;EACzB,CAAC,CAAC;AACJ,CAAC;AAEDtH,MAAM,CAACU,SAAS,CAAC8C,iBAAiB,GAAG,SAASA,iBAAiB,CAAES,IAAI,EACnEhD,QAAQ,EAAE;EACV,IAAI,CAACgD,IAAI,CAACG,GAAG,CAAC,CAAC,CAAC,EAAE;IAChB,OAAOnD,QAAQ,CAAC,IAAI0B,KAAK,CAAC,iBAAiB,CAAC,CAAC;EAC/C;EAEA,IAAIuD,GAAG,GAAGjC,IAAI,CAACzB,YAAY,EAAE;EAC7B,IAAI,CAACyB,IAAI,CAACG,GAAG,CAAC8B,GAAG,CAAC,EAAE;IAAE,OAAOjF,QAAQ,CAAC,IAAI0B,KAAK,CAAC,6BAA6B,CAAC,CAAC;EAAC;EAEhF1B,QAAQ,CAAC,IAAI,EAAE;IACbY,IAAI,EAAE,iBAAiB;IACvB0F,IAAI,EAAEtD,IAAI,CAAChC,IAAI,CAACiE,GAAG,CAAC,CAACE,QAAQ;EAC/B,CAAC,CAAC;AACJ,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}